local:
  /etc/nginx:
    file:
    - user: root
    - group: root
    - makedirs: true
    - directory
    - order: 10006
    __sls__: nginx.common
    __env__: base
  /etc/nginx/conf.d/default.conf:
    __env__: base
    __sls__: nginx.common
    file:
    - absent
    - order: 10004
  /etc/nginx/conf.d/example_ssl.conf:
    __env__: base
    __sls__: nginx.common
    file:
    - absent
    - order: 10005
  /etc/nginx/nginx.conf:
    file:
    - managed
    - template: jinja
    - user: root
    - group: root
    - mode: 644
    - source: salt://nginx/templates/config.jinja
    - require:
      - file: /etc/nginx
    - context: null
      default_user: nginx
      default_group: nginx
    - order: 10007
    __sls__: nginx.common
    __env__: base
  /etc/nginx/sites-available:
    file:
    - user: root
    - group: root
    - directory
    - order: 10009
    __sls__: nginx.common
    __env__: base
  /etc/nginx/sites-enabled:
    file:
    - user: root
    - group: root
    - directory
    - order: 10008
    __sls__: nginx.common
    __env__: base
  /usr/share/nginx:
    file:
    - directory
    - order: 10003
    __sls__: nginx.common
    __env__: base
  /var/www:
    file:
    - name: /var/www
    - user: nginx
    - group: nginx
    - mode: 755
    - makedirs: true
    - require:
      - user: nginx
      - group: nginx
    - directory
    - order: 10000
    group:
    - name: nginx
    - present
    - order: 10001
    user:
    - name: nginx
    - home: /var/www
    - groups:
      - nginx
    - require:
      - group: nginx
    - present
    - order: 10002
    __sls__: nginx.common
    __env__: base
  htpasswd:
    pkg:
    - name: httpd-tools
    - installed
    - order: 10010
    __sls__: nginx.users
    __env__: base
  nginx:
    pkg:
    - name: nginx
    - installed
    - order: 10011
    service:
    - enable: true
    - restart: true
    - watch:
      - file: /etc/nginx/nginx.conf
      - file: /etc/nginx/conf.d/default.conf
      - file: /etc/nginx/conf.d/example_ssl.conf
      - pkg: nginx
    - running
    - order: 10012
    __sls__: nginx.package
    __env__: base
